name: Deploy Demos to Production
on:
    workflow_dispatch:

jobs:
    pull-demos-from-staging:
        runs-on: ubuntu-latest

        env:
            AWS_REGION: ${{ secrets.aws_region }}
            AWS_ACCESS_KEY_ID: ${{ secrets.PL_SITE_STAGING_NON_REACT_ACCESS_KEY_ID }}
            AWS_SECRET_ACCESS_KEY: ${{ secrets.PL_SITE_STAGING_NON_REACT_SECRET_ACCESS_KEY }}
            AWS_S3_BUCKET_ID: ${{ secrets.PL_SITE_STAGING_QML_JSON_S3_BUCKET_ID }}

        steps:
            - name: Pull staging bucket
              run: |
                aws s3 cp s3://$AWS_S3_BUCKET_ID/master ./local-master
                aws s3 cp s3://$AWS_S3_BUCKET_ID/qml/searchindex.js searchindex.js
                rm -rf ./local-master/robots.txt
